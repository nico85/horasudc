{% extends 'base.html' %}
{% block titulo %}Consulta Docentes{% endblock %}

{% block contenido %}
    <div class="col-sm-12">
        <div id="form-izquierda" class="col-sm-2 well well-sm">
            <h5>Filtrar por:</h5>
            <form action="/docentes/" method="post" id="form-cons-doc">
            {% csrf_token %}
                <hr>
                <div id="sede">
                    <label for="sede">Sede: </label>
                    <select class="form-control" id="sede" name="sede">
                        <option value="0">Todas</option>
                        {% for sede in sedes %}
                            {% if sedeSel == sede.id %}
                                <option value="{{ sede.id }}" selected>{{ sede.sede_nombre }}</option>
                            {% else %}
                                <option value="{{ sede.id }}">{{ sede.sede_nombre }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
                <hr>
                <div id="carrera">
                    <label for="carrera">Carreras: </label>
                    <select class="form-control" id="carrera" name="carrera">
                        <option value="0">Todas</option>
                        {% for c in carreras %}
                            {% if carreraSel == c.id %}
                                <option value="{{ c.id }}" selected>{{ c.carrera_nombre }}</option>
                            {% else %}
                                <option value="{{ c.id }}">{{ c.carrera_nombre }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
                <hr>
                <div id="anio">
                    <label for="anio">Año: </label>
                    <select class="form-control" id="anio" name="anio">
                        <option value="0">Todos</option>
                        {% for a in anios %}
                            {% if anioSel == a %}
                                <option value="{{ a }}" selected>{{ a }}</option>
                            {% else %}
                                <option value="{{ a }}">{{ a }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>
                <hr>
                <div id="fecha_desde">
                    <label for="fecha_desde">Desde: {{ fechaDesdeSel }}</label>
                    {% if fechaDesdeSel != "" %}
                        <input type="date" placeholder="Fecha desde" id="fecha_desde" name="fecha_desde" value="{{ fechaDesdeSel }}">
                    {% else %}
                        <input type="date" placeholder="Fecha desde" id="fecha_desde" name="fecha_desde">
                    {% endif %}
                </div>
                <hr>
                <div id="fecha_hasta">
                    <label for="fecha_hasta">Hasta: {{ fechaHastaSel }}</label>
                    {% if fechaHastaSel != "" %}
                        <input type="date" placeholder="Fecha hasta" id="fecha_hasta" name="fecha_hasta" value="{{ fechaHastaSel }}">
                    {% else %}
                        <input type="date" placeholder="Fecha hasta" id="fecha_hasta" name="fecha_hasta">
                    {% endif %}
                </div>
                <hr>
                <div class="btn-group-vertical" style="width: 100%">
                    <button type="submit"class="btn btn-info" onclick="validarFechas()">
                        <img src="../static/img/icono_filtrar-white_24.png">
                        Filtrar
                    </button>
                    <a class="btn btn-success" href="/docentes">Nueva consulta</a>
                </div>
            </form>
        </div>
        <div id="contenido-consulta" clasS="col-sm-10">
            {% if docentes.count > 0 %}
                <h5>Lista del Personal docente de la Universidad del Chubut</h5>
                <h6>(se encontraron {{ docentes.count }} resultados, de un total de {{ total_docs }} asignaciones)</h6>
                <div class="table-responsive">
                    <table class="table table-hover table-bordered table-condensed">
                        <thead>
                            <tr>
                                <th>Legajo</th>
                                <th>Nombre y apellido</th>
                                <th>Sede</th>
                                <th>Carrera</th>
                                <th>Materia</th>
                                <th>Resolución</th>
                                <th>Desde</th>
                                <th>Hasta</th>
                                <th>Horas</th>
                                <th>Hs. Total</th>
                                <th>Hs a liquidar</th>
                                <th>Año Académico</th>
                                <th>Periodo</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for d in docentes %}
                                <tr>
                                    <td>{{ d.persona.legajo_numero }}</td>
                                    <td>{{ d.persona.apellidos }}, {{ d.persona.nombres }}</td>
                                    <td>{{ d.sede }}</td>
                                    <td>{{ d.materia.plan.carrera.carrera_nombre }}</td>
                                    <td>{{ d.materia.materia_nombre }}</td>
                                    <td>{{ d.resolucion_numero }}/{{ d.resolucion_anio }}</td>
                                    <td>{{ d.fecha_inicio | date:"d/m/Y" }}</td>
                                    <td>{{ d.fecha_fin | date:"d/m/Y" }}</td>
                                    <td>{{ d.materia.hs_semanales }}</td>
                                    <td>{{ d.materia.hs_total_materia }}</td>
                                    <td>
                                        {% for l in lista_hs %}
                                            {% if d.id == l.id_doc %}
                                                {{ l.tot_hs }}
                                            {% endif %}
                                        {% endfor %}
                                    </td>
                                    <td>{{ d.materia.anio_academico }}</td>
                                    <td>{{ d.materia.periodo.periodo_nombre }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                    <div align="right">
                        <a href="/doc/export/xls/" class="btn btn-success">
                            <img src="../static/img/icon_excel-white_24.png"></a>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-warning">
                    <h3>No se encontró ningún resultado según los filtros marcados.</h3>
                </div>
            {% endif %}
        </div>

    </div>
{% endblock %}
